for x = -1.5:1e-4:1.5

    fprintf('\nprocessing');
    fprintf('%7.3f',[coeff,x]);

    curmaxerr = max(errfun(x,coeff,freqp,phred,bigsint,bigcost));

    fprintf(' #MAXERR curnt = %6.1f std = %6.1f',curmaxerr,maxerr);

    if(length(coeff) == 1)
        stableflag = isstable(fliplr([1,x]),[1,x]);
    else
        stableflag = isstable( ...
            fliplr([1,coeff(2:length(coeff)),x]),[1,coeff(2:length(coeff)),x]);
    end

    if((curmaxerr < maxerr) && stableflag)
        newcoeff = x;
        maxerr = curmaxerr;
        fprintf(' # refreshed!')
    elseif((curmaxerr > maxerr))
        break;
    end
end

newerr = maxerr;
maxerr = inf;

tol = ((max(abs(2*atan(newerr))) - max(abs(2*atan(olderr)))) ...
       / max(abs(2*atan(olderr))));

if(tol < delta)
    fprintf('\nstep out by error tolerance never changes!\n');
    fprintf('error tolerance fail with %12.6f\n',tol);
    break;
end

olderr = newerr;
coeff = [coeff,newcoeff];
